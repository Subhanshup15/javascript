<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Student Management System</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Cambria, serif;
        }

        body {
            background: #dad7cd;
            color: #222;
        }


        .conatiner {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(3, auto);
            gap: 10px;
            min-height: 100vh;
            padding: 10px;
        }


        .conatiner>div {
            background: #16213e;
            border-radius: 10px;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .item-1 {
            grid-column: 1/2;
            grid-row: 1/4;
        }

        .item-2 {
            grid-column: 3/4;
        }

        .item-2-card {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .stat-card {

            background: #ffffff;
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            box-shadow: 0 6px 14px rgba(0, 0, 0, .18);
        }

        .stat-card h4 {

            color: #00bcd4;
            font-size: 15px;
        }

        .stat-card:first-child {
            border-left-color: #000000;
        }

        .stat-text span {
            display: block;
            font-weight: bold;
            font-size: 14px;
        }


        .item-3 {
            grid-column: 4/5;
        }

        .item-4 {
            grid-column: 5/6;
        }

        .item-5 {
            grid-column: 3/6;
            grid-row: 2/4;
        }

        .item-5 h3 {
            color: #cfd8ff;
            margin: 12px 0 8px;
        }

        /* Test-wise cards */
        .item-5 .subject-grid:last-of-type .subject-box {
            background: #ffffff;
            border-radius: 10px;
            padding: 14px 12px;
            box-shadow: 0 6px 14px rgba(0, 0, 0, .18);
            border-left: 6px solid #3498db;
            /* default accent */
            text-align: left;
        }

        /* Test titles */
        .item-5 .subject-grid:last-of-type .subject-box {
            font-weight: 600;
            font-size: 15px;
        }

        /* Subject rows */
        .item-5 .subject-grid:last-of-type .subject-box div {
            margin-top: 6px;
            font-size: 14px;
            font-weight: 500;
        }

        /* Subject labels */
        .item-5 .subject-grid:last-of-type .subject-box div span {
            font-weight: bold;
        }

        /* Color accents per test */
        .item-5 .subject-grid:last-of-type .subject-box:nth-child(1) {
            border-left-color: #2ecc71;
            /* Unit Test */
        }

        .item-5 .subject-grid:last-of-type .subject-box:nth-child(2) {
            border-left-color: #f39c12;
            /* Mid Test */
        }

        .item-5 {
            border-left-color: #9b59b6;
            /* Final Test */
        }

        .item-6 {
            grid-column: 2/3;
            grid-row: 1/4;
        }

        .item-7 {
            grid-column: 1/6;
        }


        h3 {
            color: #cfd8ff;
            font-size: 17px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 8px;
        }

        form {
            background: #ffffff;
            padding: 14px;
            border-radius: 10px;
        }

        input,
        select,
        button {
            width: 100%;
            padding: 8px;
            margin: 6px 0;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
        }

        button {
            background: #4CAF50;
            color: #fff;
            border: none;
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background: #43a047;
        }



        .result-main-box {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .result-box {
            background: #ffffff;
            border-radius: 10px;
            padding: 14px;
            text-align: center;
            box-shadow: 0 6px 14px rgba(0, 0, 0, .18);
            border-left: 6px solid transparent;
        }

        .result-box h5 {
            font-size: 14px;
            margin-bottom: 6px;
        }


        .result-box:first-child {
            border-left-color: #2ecc71;
        }

        .result-box:first-child h5,
        #passCount,
        #passCountPer {
            color: #2ecc71;
        }


        .result-box:last-child {
            border-left-color: #e74c3c;
        }

        .result-box:last-child h5,
        #failCount,
        #failCountPer {
            color: #e74c3c;
        }

        #passCount,
        #failCount {
            font-size: 26px;
            font-weight: bold;
        }

        #passCountPer,
        #failCountPer {
            font-size: 18px;
        }


        .subject-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .subject-box-1 {
            background: #ffffff;
            border-radius: 10px;
            padding: 12px;
            text-align: left;
            box-shadow: 0 6px 14px rgba(0, 0, 0, .18);
            /* font-weight: 500; */
        }

        .subject-box-1 span {
            margin-top: 6px;
            font-size: 18px;
            font-weight: bold;
        }

        .subject-box {
            background: #ffffff;
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            box-shadow: 0 6px 14px rgba(0, 0, 0, .18);
            font-weight: 500;
        }

        .subject-box span {
            display: block;
            margin-top: 6px;
            font-size: 18px;
            font-weight: bold;
        }


        table {
            width: 100%;
            border-collapse: collapse;
            background: #ffffff;
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background: #4CAF50;
            color: #fff;
            padding: 8px;
            font-size: 14px;
        }

        td {
            padding: 7px;
            border: 1px solid #ddd;
            font-size: 14px;
            text-align: center;
        }

        .student-table-scroll {
            max-height: 60vh;
            overflow-y: auto;
        }


        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, .6);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #ffffff;
            padding: 20px;
            width: 90%;
            max-width: 700px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, .35);
        }

        .close {
            float: right;
            font-size: 22px;
            cursor: pointer;
            color: #e74c3c;
        }
    </style>
</head>

<body>

    <div class="conatiner">

        <!-- ADD MARKS -->
        <div class="item-1">
            <h3> Add Student Mark Test Wise </h3>
            <form id="addStudentMarks">
                <button type="button" onclick="openStudentModal()">Add Student</button>

                <input id="searchRoll" placeholder="Enter Roll No">
                <input id="studentName" placeholder="Name" readonly>

                <select id="testType">
                    <option value="unitTest">Unit Test</option>
                    <option value="midTest">Mid Test</option>
                    <option value="finalTest">Final Test</option>
                </select>

                <input id="marathi" placeholder="Marathi" oninput="this.value = this.value.replace(/[^0-9]/g, '');">
                <input id="hindi" placeholder="Hindi" oninput="this.value = this.value.replace(/[^0-9]/g, '');">
                <input id="english" placeholder="English" oninput="this.value = this.value.replace(/[^0-9]/g, '');">

                <button type="submit">Add Marks</button>
                <button type="button" onclick="resetAddMarksForm()">Reset</button>
            </form>
        </div>

        <!-- DASHBOARD -->
        <div class="item-2">
            <h3> Final Result TOP -LOW </h3>
            <div class="item-2-card">
                <div class="stat-card">
                    ðŸŽ“
                    <h4> Topper</h4>
                    <div class="stat-text">
                        <span id="topperName">0</span>

                        <span id="topperMark">0</span>
                    </div>
                </div>

                <div class="stat-card">
                    ðŸ“‰
                    <h4> Lower</h4>
                    <div class="stat-text">
                        <span id="LowerName">-</span>
                        <span id="LowerMark">-</span>
                    </div>
                </div>
            </div>

        </div>


        <div class="item-3">
            <h3>Final Result</h3>
            <div class="result-main-box">
                <div class="result-box">
                    <h5>Pass</h5>
                    <div id="passCount">-</div>
                    <p>Percentage</p>
                    <div id="passCountPer">-</div>
                </div>

                <div class="result-box">
                    <h5>Fail</h5>
                    <div id="failCount">-</div>

                    <span id="failCountPer">-</span>
                </div>
            </div>

        </div>


        <div class="item-4">
            <h3> As Per Test Percentage</h3>
            <div class="subject-grid">
                <div class="subject-box-1">
                    <h4 style="color: #00d9ff; font-size: 2vh;"> Unit Test</h4>
                    <div>Pass: <span id="unitPass">0</span></div>
                    <div>Fail: <span id="unitFail">0</span></div>
                    <span id="unitPer">0%</span>
                </div>

                <div class="subject-box-1">
                    <h4 style="color: #00d9ff; font-size: 2vh;">Mid Test</h4>
                    <div>Pass: <span id="midPass">0</span></div>
                    <div>Fail: <span id="midFail">0</span></div>
                    <span id="midPer">0%</span>
                </div>

                <div class="subject-box-1">
                    <h4 style="color: #00d9ff; font-size: 2vh;">Final Test</h4>
                    <div>Pass: <span id="finalPass">0</span></div>
                    <div>Fail: <span id="finalFail">0</span></div>
                    <span id="finalPer">0%</span>
                </div>
            </div>
        </div>

        <div class="item-5">

            <h3>Test Wise Subject Pass / Fail</h3>

            <div class="subject-grid">
                <div class="subject-box">
                    Unit Test
                    <div>Marathi: <span id="unitM">0/0</span></div>
                    <div>Hindi: <span id="unitH">0/0</span></div>
                    <div>English: <span id="unitE">0/0</span></div>
                </div>

                <div class="subject-box">
                    Mid Test
                    <div>Marathi: <span id="midM">0/0</span></div>
                    <div>Hindi: <span id="midH">0/0</span></div>
                    <div>English: <span id="midE">0/0</span></div>
                </div>

                <div class="subject-box">
                    Final Test
                    <div>Marathi: <span id="finalM">0/0</span></div>
                    <div>Hindi: <span id="finalH">0/0</span></div>
                    <div>English: <span id="finalE">0/0</span></div>
                </div>
            </div>
        </div>


        <div class="item-6">
            <h3>Student Master</h3>

            <input type="text" id="studentMasterSearch" placeholder="Search Roll No or Name"
                oninput="filterStudentMaster()">
            <div class="student-table-scroll">

                <table>
                    <thead>
                        <tr>
                            <th>Roll No</th>
                            <th>Name</th>
                        </tr>
                    </thead>
                    <tbody id="studentMasterBody">
                        <!-- rows from JS -->
                    </tbody>
                </table>
            </div>
        </div>


        <div class="item-7">
            <input placeholder="Search table..." oninput="filterTable(this.value)">
            <table>
                <thead>
                    <tr>
                        <th>Roll</th>
                        <th>Name</th>
                        <th>%</th>
                        <th>Status</th>
                        <th>Grade</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>

    </div>

    <!-- STUDENT MASTER MODAL -->
    <div class="modal" id="studentModal">
        <form id="addStudentMaster" class="modal-content">
            <span class="close" onclick="closeStudentModal()">Ã—</span>
            <input id="rollNo" placeholder="Roll No" oninput="this.value = this.value.replace(/[^0-9]/g, '');">
            <input id="name" placeholder="Name">
            <button type="submit">Save</button>
        </form>
    </div>

    <!-- DETAILS MODAL -->
    <div class="modal" id="detailsModal">
        <div class="modal-content">
            <span class="close" onclick="closeDetails()">Ã—</span>

            <!-- Student Name -->
            <h3 id="detailStudentName"></h3>
            <table>
                <thead>
                    <tr>
                        <th>Test</th>
                        <th>Marathi</th>
                        <th>Hindi</th>
                        <th>English</th>
                        <th>%</th>
                        <th>Grade</th>
                        <th>Action</th>

                    </tr>
                </thead>
                <tbody id="detailsBody">
                </tbody>
            </table>

        </div>
    </div>


    <div class="modal" id="editTestModal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">Ã—</span>

            <h3>Edit Test Marks</h3>
            <p><strong>Test Type:</strong> <span id="editTestTypeName">-</span></p>

            <!-- hidden helpers -->
            <input type="hidden" id="editRollNo">
            <input type="hidden" id="editTestType">

            <label>Marathi</label>
            <input id="editMarathi" type="number">

            <label>Hindi</label>
            <input id="editHindi" type="number">

            <label>English</label>
            <input id="editEnglish" type="number">

            <button onclick="saveEditedMarks()">Save Changes</button>
        </div>
    </div>


    <!-- Alert Modal -->
    <div class="alertcss" id="alertModal">
        <div class="alertcss-content">
            <span class="alertcss-close" id="closeAlertModal">&times;</span>
            <p id="alertModalMessage">-</p>
        </div>
    </div>


</body>
<script>
    /* ===== STORAGE ===== */
    let studentsMaster = JSON.parse(localStorage.getItem("studentsMaster")) || [];
    let studentMarks = JSON.parse(localStorage.getItem("studentMarks")) || [];

    /* ===== ELEMENTS ===== */
    const addStudentMarks = document.getElementById("addStudentMarks");
    const addStudentMaster = document.getElementById("addStudentMaster");

    /* ===== SEARCH STUDENT ===== */
    searchRoll.addEventListener("input", () => {
        const s = studentsMaster.find(x => x.rollNo === Number(searchRoll.value));
        studentName.value = s ? s.name : "-";
    });


    addStudentMaster.addEventListener("submit", function (event) {
        event.preventDefault();

        const rollNO = Number(document.getElementById("rollNo").value);
        const name = document.getElementById("name").value;

        const rollNumberID = studentsMaster.find(s => s.rollNo === rollNO);
        if (rollNumberID) {
            alert("RollNo already exists");
            return;
        }
        studentsMaster.push({
            rollNo: rollNO,
            name: name
        });
        localStorage.setItem("studentsMaster", JSON.stringify(studentsMaster));
        addStudentMaster.reset();
        showAlert("Student Added");
    });

    function resetAddMarksForm() {
        const form = document.getElementById("addStudentMarks");
        form.reset();

        // clear readonly field safely
        document.getElementById("studentName").value = "";
    }




    /* ===== ADD MARKS ===== */
    addStudentMarks.addEventListener("submit", function (event) {
        event.preventDefault();

        const rollNo = Number(document.getElementById("searchRoll").value);
        const student = studentsMaster.find(s => s.rollNo === rollNo);

        if (!student) {
            return alert("Student not found!");
        }

        const testType = document.getElementById("testType").value;
        console.log("testType==>", testType);

        const existingStudent = studentMarks.find(s => s.rollNo === rollNo);

        if (existingStudent && existingStudent[testType]) {
            showAlert(`Marks for ${testType} are already filled for this student`);
            return;
        }

        const marksEntry = {
            rollNo,
            name: student.name,
            [testType]: {
                Marathi: Number(document.getElementById("marathi").value),
                Hindi: Number(document.getElementById("hindi").value),
                English: Number(document.getElementById("english").value)
            }
        };


        studentMarks.push(marksEntry);


        localStorage.setItem("studentMarks", JSON.stringify(studentMarks));
        renderTable();
        updateDashboard();
        addStudentMarks.reset();

        showAlert("Student Marks Added");
    });

    function grade(p) {
        p = Number(p);
        if (p >= 80) return "A+";
        if (p >= 60) return "B+";
        if (p >= 50) return "B";
        if (p >= 35) return "C";
        return "Fail";
    }

    /* ===== TABLE ===== */
    function renderTable() {
        let passCount = 0;
        let failCount = 0;
        let unitPass = 0, unitFail = 0;
        let midPass = 0, midFail = 0;
        let finalPass = 0, finalFail = 0;
        tableBody.innerHTML = "";

        for (let i = 0; i < studentMarks.length; i++) {
            let student = studentMarks[i];


            let total = 0;
            let count = 0;

            let isTestFail = false;


            let testTypes = ["unitTest", "midTest", "finalTest"];



            if (student.unitTest) {
                let m = student.unitTest.Marathi;
                let h = student.unitTest.Hindi;
                let e = student.unitTest.English;

                if (m < 35 || h < 35 || e < 35) {
                    unitFail++;
                    studentFail = true;
                } else {
                    unitPass++;
                }
            }

            if (student.midTest) {
                let m = student.midTest.Marathi;
                let h = student.midTest.Hindi;
                let e = student.midTest.English;

                if (m < 35 || h < 35 || e < 35) {
                    midFail++;
                    studentFail = true;
                } else {
                    midPass++;
                }
            }


            if (student.finalTest) {
                let m = student.finalTest.Marathi;
                let h = student.finalTest.Hindi;
                let e = student.finalTest.English;

                if (m < 35 || h < 35 || e < 35) {
                    finalFail++;
                    studentFail = true;
                } else {
                    finalPass++;
                }
            }

            for (let j = 0; j < testTypes.length; j++) {
                let testName = testTypes[j];

                if (student[testName]) {

                    let marathi = student[testName].Marathi;
                    let hindi = student[testName].Hindi;
                    let english = student[testName].English;

                    total = total + marathi + hindi + english;
                    count = count + 3;



                    if (marathi < 35 || hindi < 35 || english < 35) {
                        isTestFail = true;
                    }


                }
            }


            if (isTestFail === true) {
                failCount = failCount + 1;
            } else {
                passCount = passCount + 1;
            }

            totalAvgCount = passCount + failCount;
            passCountPer = ((passCount / totalAvgCount) * 100).toFixed(2);
            failCountPer = ((failCount / totalAvgCount) * 100).toFixed(2);


            let percentage = "--";
            if (count > 0) {
                percentage = ((total / (count * 100)) * 100).toFixed(2);
            }


            let tr = document.createElement("tr");

            tr.innerHTML =
                "<td style='color:blue;cursor:pointer'>" + student.rollNo + "</td>" +
                "<td>" + student.name + "</td>" +
                "<td>" + percentage + "%</td>" +
                "<td>" + (isTestFail ? "Fail" : "Pass") + "</td>" +
                "<td>" + grade(percentage) + "</td>";

            tr.onclick = function () {
                showDetails(student);
            };

            tableBody.appendChild(tr);
        }


        let unitTotal = unitPass + unitFail;
        let midTotal = midPass + midFail;
        let finalTotal = finalPass + finalFail;




        document.getElementById("failCount").textContent = failCount;
        document.getElementById("passCount").textContent = passCount;

        document.getElementById("passCountPer").textContent = passCountPer;
        document.getElementById("failCountPer").textContent = failCountPer;

        document.getElementById("unitPass").innerText = unitPass;
        document.getElementById("unitFail").innerText = unitFail;
        document.getElementById("unitPer").innerText = unitTotal ? ((unitPass / unitTotal) * 100).toFixed(2) + "%" : "0%";

        document.getElementById("midPass").innerText = midPass;
        document.getElementById("midFail").innerText = midFail;
        document.getElementById("midPer").innerText = midTotal ? ((midPass / midTotal) * 100).toFixed(2) + "%" : "0%";

        document.getElementById("finalPass").innerText = finalPass;
        document.getElementById("finalFail").innerText = finalFail;
        document.getElementById("finalPer").innerText = finalTotal ? ((finalPass / finalTotal) * 100).toFixed(2) + "%" : "0%";

    }


    /* ===== DETAILS ===== */
    function showDetails(student) {
        document.getElementById("detailStudentName").innerText = student.name;

        const tbody = document.getElementById("detailsBody");
        tbody.innerHTML = "";

        const tests = ["unitTest", "midTest", "finalTest"];
        const testNames = {
            unitTest: "Unit Test",
            midTest: "Mid Test",
            finalTest: "Final Test"
        };

        for (let i = 0; i < tests.length; i++) {
            const t = tests[i];

            console.log("==>", t)
            if (!student[t]) continue;

            const m = student[t].Marathi;
            const h = student[t].Hindi;
            const e = student[t].English;

            const total = m + h + e;
            const percent = ((total / 300) * 100).toFixed(2);

            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${testNames[t]}</td>
                <td>${m}</td>
                <td>${h}</td>
                <td>${e}</td>
                <td>${percent}%</td>
                <td>${grade(percent)}</td>
                <td>
                <button onclick="openEditModal(${student.rollNo}, '${t}')">
                    Edit
                </button>
                </td>
                `;

            tbody.appendChild(tr);
        }

        detailsModal.style.display = "flex";
    }


    ///edit marks 
    function openEditModal(rollNo, testType) {
        const student = studentMarks.find(s => s.rollNo === rollNo);
        if (!student || !student[testType]) return;

        // store helpers
        document.getElementById("editRollNo").value = rollNo;
        document.getElementById("editTestType").value = testType;

        const testNames = {
            unitTest: "Unit Test",
            midTest: "Mid Test",
            finalTest: "Final Test"
        };
        document.getElementById("editTestTypeName").innerText = testNames[testType];

        // fill marks
        document.getElementById("editMarathi").value = student[testType].Marathi;
        document.getElementById("editHindi").value = student[testType].Hindi;
        document.getElementById("editEnglish").value = student[testType].English;

        // open modal
        document.getElementById("editTestModal").style.display = "flex";
    }

    function saveEditedMarks() {
        const rollNo = Number(document.getElementById("editRollNo").value);
        const testType = document.getElementById("editTestType").value;

        const student = studentMarks.find(s => s.rollNo === rollNo);
        if (!student || !student[testType]) return;

        student[testType].Marathi = Number(document.getElementById("editMarathi").value) || 0;
        student[testType].Hindi = Number(document.getElementById("editHindi").value) || 0;
        student[testType].English = Number(document.getElementById("editEnglish").value) || 0;

        localStorage.setItem("studentMarks", JSON.stringify(studentMarks));

        closeEditModal();
        closeDetails();
        renderTable();
        updateDashboard();
    }
    function closeEditModal() {
        document.getElementById("editTestModal").style.display = "none";
    }



    /* ===== DASHBOARD ===== */
    function updateDashboard() {
        let tp = -Infinity,
            lp = Infinity,
            tn = "-",
            ln = "-",
            pass = 0,
            fail = 0,
            m = 0,
            h = 0,
            e = 0;
        const test = testType.value;

        studentMarks.forEach(s => {


            let testType = ["unitTest", "midTest", "finalTest"];
            let tot = 0, c = 0;


            testType.forEach(t => {
                if (s[t]) { tot += s[t].Marathi + s[t].Hindi + s[t].English; c += 3; }
            });
            if (c) {
                const p = (tot / (c * 100)) * 100;
                if (p > tp) { tp = p; tn = s.name; }
                if (p < lp) { lp = p; ln = s.name; }
            }
            if (s[test]) {
                if (s[test].Marathi >= 35 && s[test].Hindi >= 35 && s[test].English >= 35) pass++;
                else fail++;
                if (s[test].Marathi >= 35) m++;
                if (s[test].Hindi >= 35) h++;
                if (s[test].English >= 35) e++;
            }

            testType.forEach(t => {
                if (!s[t]) return;

                s[t].Marathi >= 35 ? testStats[t].M.p++ : testStats[t].M.f++;
                s[t].Hindi >= 35 ? testStats[t].H.p++ : testStats[t].H.f++;
                s[t].English >= 35 ? testStats[t].E.p++ : testStats[t].E.f++;
            });


        });
        // Unit Test
        unitM.innerText = ` Pass: ${testStats.unitTest.M.p} Fail:${testStats.unitTest.M.f}`;
        unitH.innerText = `Pass:${testStats.unitTest.H.p}/ Fail:${testStats.unitTest.H.f}`;
        unitE.innerText = `${testStats.unitTest.E.p}/${testStats.unitTest.E.f}`;

        // Mid Test
        midM.innerText = `${testStats.midTest.M.p}/${testStats.midTest.M.f}`;
        midH.innerText = `${testStats.midTest.H.p}/${testStats.midTest.H.f}`;
        midE.innerText = `${testStats.midTest.E.p}/${testStats.midTest.E.f}`;

        // Final Test
        finalM.innerText = `${testStats.finalTest.M.p}/${testStats.finalTest.M.f}`;
        finalH.innerText = `${testStats.finalTest.H.p}/${testStats.finalTest.H.f}`;
        finalE.innerText = `${testStats.finalTest.E.p}/${testStats.finalTest.E.f}`;




        const topperMarkEl = document.getElementById("topperMark");
        const lowerMarkEl = document.getElementById("LowerMark");
        const topperNameEl = document.getElementById("topperName");
        const lowerNameEl = document.getElementById("LowerName");

        if (studentMarks.length > 0 && isFinite(tp) && isFinite(lp)) {
            topperMarkEl.textContent = tp.toFixed(2) + "%";
            lowerMarkEl.textContent = lp.toFixed(2) + "%";
            topperNameEl.textContent = tn;
            lowerNameEl.textContent = ln;
        } else {
            topperMarkEl.textContent = "0%";
            lowerMarkEl.textContent = "0%";
            topperNameEl.textContent = "-";
            lowerNameEl.textContent = "-";
        }




    }

    let testStats = {
        unitTest: { M: { p: 0, f: 0 }, H: { p: 0, f: 0 }, E: { p: 0, f: 0 } },
        midTest: { M: { p: 0, f: 0 }, H: { p: 0, f: 0 }, E: { p: 0, f: 0 } },
        finalTest: { M: { p: 0, f: 0 }, H: { p: 0, f: 0 }, E: { p: 0, f: 0 } }
    };


    /* ===== UTILS ===== */
    function filterTable(v) {
        [...tableBody.rows].forEach(r => {
            r.style.display = r.innerText.toLowerCase().includes(v.toLowerCase()) ? "" : "none";
        });
    }

    function openStudentModal() { studentModal.style.display = "flex"; }
    function closeStudentModal() { studentModal.style.display = "none"; }
    function closeDetails() { detailsModal.style.display = "none"; }



    function renderStudentMaster() {
        const tbody = document.getElementById("studentMasterBody");
        tbody.innerHTML = "";
        for (let i = 0; i < studentsMaster.length; i++) {
            const tr = document.createElement("tr");

            tr.innerHTML = `
            <td>${studentsMaster[i].rollNo}</td>
            <td>${studentsMaster[i].name}</td>
            `;
            tbody.appendChild(tr);
        }
    }
    function filterStudentMaster() {
        const query = document.getElementById("studentMasterSearch").value.toLowerCase();
        const rows = document.querySelectorAll("#studentMasterBody tr");
        rows.forEach(row => {
            row.style.display = row.innerText.toLowerCase().includes(query)
                ? ""
                : "none";
        });
    }

    renderTable();
    updateDashboard();
    renderStudentMaster();









    // alertModal  
    const alertModal = document.getElementById("alertModal");
    const alertModalMessage = document.getElementById("alertModalMessage");
    const closeAlertModal = document.getElementById("closeAlertModal");

    function showAlert(message) {
        alertModalMessage.textContent = message;
        alertModal.style.display = "flex";

        setTimeout(() => {
            alertModal.style.display = "none";
            if (addStudentMarks) addStudentMarks.reset();
        }, 1000);
    }

    closeAlertModal.addEventListener("click", function () {
        alertModal.style.display = "none";
    });

    window.addEventListener("click", function (event) {
        if (event.target === alertModal) {
            alertModal.style.display = "none";
        }
    });

</script>

</html>